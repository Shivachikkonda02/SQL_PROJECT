CREATE DATABASE COMPANY;

USE COMPANY;

CREATE TABLE EMPLOYEE(
EMPID INT NOT NULL PRIMARY KEY,
FIRST_NAME VARCHAR(25),
LAST_NAME VARCHAR(25),
SALARY INT,
JOINING_DATE DATETIME,
DEPARTMENT_NAME VARCHAR(25)
);

INSERT INTO EMPLOYEE VALUES
(0001,'KRISH','NAIK',50000,'14-12-11 09.00.00','DEVELOPMENT'),
(0002,'SUDHANSHU','KUMAR',60000,'14-12-11 09.00.00','DEVELOPMENT'),
(0003,'SANKET','KUMAR',70000,'15-12-12 09.00.00','HR'),
(0004,'DARIUS','BENGALI',30000,'15-12-13 09.00.00','HR'),
(0005,'SATISH','BHANSAL',30000,'17-10-21 09.00.00','ACCOUNTANT'),
(0006,'SHAKTIMAN','HERO',50000,'17-10-15 09.00.00','ACCOUNTANT');

SELECT * FROM EMPLOYEE;


CREATE TABLE BONUS(
EMP_REF_ID INT,
BONUS_AMT INT,
BONUS_DATE DATETIME,
FOREIGN KEY (EMP_REF_ID) REFERENCES EMPLOYEE(EMPID)
ON DELETE CASCADE
);

INSERT INTO BONUS VALUES
(0001,5000,'16-03-04'),
(0002,5000,'16-03-13'),
(0003,5000,'17-03-15'),
(0004,5000,'18-03-17'),
(0001,3500,'16-03-19'),
(0005,7000,'16-03-20'),
(0001,8000,'20-03-21'),
(0002,8500,'20-03-21');

SELECT * FROM BONUS;

CREATE TABLE DESIGNATION(
EMP_REF_ID INT,
DESIGNATION VARCHAR(25),
DESIGNATION_DATE DATETIME,
foreign key(EMP_REF_ID) references EMPLOYEE(EMPID)
);

INSERT INTO DESIGNATION VALUES
(1,'MANAGER','2016-02-05 00:00:00'),
(2,'EXECUTIVE','2016-06-11 00:00:00'),
(3,'EXECUTIVE','2016-06-11 00:00:00');

-- 1.Write an sql query to retrive all details where first name frome employee 
# table which starts with 'k'

SELECT * FROM EMPLOYEE
WHERE FIRST_NAME LIKE "K%";

-- 2.Write an sql query to print all details of the employees whose salary 
# between 10000 to 35000
# fetch Employee name

SELECT FIRST_NAME,LAST_NAME,SALARY FROM EMPLOYEE 
WHERE SALARY BETWEEN 10000 AND 35000;

SELECT CONCAT(FIRST_NAME,' ',LAST_NAME) AS EMPLOYEE_NAME, SALARY
FROM EMPLOYEE WHERE SALARY BETWEEN 10000 AND 35000;

-- 3.Sql query to retrive detials of the employees who have joined on date
##  DEC 2014

SELECT * FROM EMPLOYEE 
WHERE YEAR(JOINING_DATE)=2014 AND MONTH(JOINING_DATE)=12; 


-- 4.Sql query to fetch number of employees in every department

SELECT COUNT(*) FROM EMPLOYEE
WHERE DEPARTMENT_NAME= 'DEVELOPMENT';

SELECT COUNT(*) FROM EMPLOYEE 
WHERE DEPARTMENT_NAME='HR';

SELECT COUNT(*) FROM EMPLOYEE 
WHERE DEPARTMENT_NAME='ACCOUNTANT';

SELECT COUNT(*) FROM EMPLOYEE
GROUP BY DEPARTMENT_NAME;

## INTERMEDIATE
-- 5. Sql query to print details of the employee who are also Executives

SELECT EMPLOYEE.FIRST_NAME,DESIGNATION.DESIGNATION FROM EMPLOYEE 
INNER JOIN DESIGNATION 
ON EMPLOYEE.EMPID = DESIGNATION.EMP_REF_ID
AND 
DESIGNATION.DESIGNATION='EXECUTIVE';

-- 6.Sql query to clone a new table from another table

CREATE TABLE CLONE_EMPLOYEE LIKE EMPLOYEE;

SELECT * FROM CLONE_EMPLOYEE;

-- 7.Sql query to show top n salary of employees

SELECT * FROM EMPLOYEE 
ORDER BY SALARY DESC
LIMIT 5;

-- 8.Sql query to determine the 6th highest salary
SELECT SALARY FROM EMPLOYEE
ORDER BY SALARY
LIMIT 1 OFFSET 5;

SELECT SALARY FROM EMPLOYEE
ORDER BY SALARY
LIMIT 5,1;




